<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-US" xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from www.w3schools.com/php/php_db_odbc.asp?output=print by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 15 Oct 2011 23:20:37 GMT -->
<head>
<title>PHP Database ODBC</title>
 
<link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="Keywords" content="html,css,tutorial,html5,dhtml,css3,xsl,xslt,xhtml,javascript,jquery,asp,ado,net,vbscript,dom,sql,colors,soap,php,rss,authoring,programming,training,learning,quiz,beginner's guide,primer,lessons,school,howto,reference,examples,samples,source code,tags,demos,tips,links,FAQ,tag list,forms,frames,color table,w3c,cascading style sheets,active server pages,dynamic html,internet,database,development,Web building,Webmaster,html guide" />

<meta name="Description" content="Free HTML XHTML CSS JavaScript jQuery XML DOM XSL XSLT RSS AJAX ASP .NET PHP SQL tutorials, references, examples for web building." />

<link rel="stylesheet" type="text/css" href="../stdtheme.css" />
<script type="text/javascript">
<!--
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
//-->
</script>
<script type="text/javascript">
<!--
function searchfield_focus(obj)
{
obj.style.color=""
obj.style.fontStyle=""
if (obj.value=="Search w3schools.com")
	{
	obj.value=""
	}
}

var pageTracker = _gat._getTracker("UA-3855518-1");
pageTracker._initData();
pageTracker._trackPageview();

var addr=document.location.href;
function displayError()
{
document.getElementById("err_url").value=addr;
document.getElementById("err_form").style.display="block";
document.getElementById("err_desc").focus();
hideSent();
}
function hideError()
{
document.getElementById("err_form").style.display="none";
}
function hideSent()
{
document.getElementById("err_sent").style.display="none";
}
function sendErr()
{
var xmlhttp;
var err_url=document.getElementById("err_url").value;
var err_email=document.getElementById("err_email").value;
var err_desc=document.getElementById("err_desc").value;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }

xmlhttp.open("POST","../err_sup.html",true);
xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
xmlhttp.send("err_url=" + err_url + "&err_email=" + err_email + "&err_desc=" + escape(err_desc));
hideError();
document.getElementById("err_sent").style.display="block";
}

function click_expandingMenuHeader(obj,sectionName)
{
var x=document.getElementById("cssprop_" + sectionName).parentNode.className;
if (x.indexOf("expandingMenuNotSelected")>-1)
	{
	x=x.replace("expandingMenuNotSelected","expandingMenuSelected");
	document.getElementById("cssprop_" + sectionName).parentNode.className=x;
	document.getElementById("cssprop_" + sectionName).style.display="block";
	}
else
	{
	x=x.replace("expandingMenuSelected","expandingMenuNotSelected");
	document.getElementById("cssprop_" + sectionName).parentNode.className=x;
	document.getElementById("cssprop_" + sectionName).style.display="none";
	}
}

//-->
</script>
<!--[if lt IE 7]>
<style>
#leftcolumn{margin-left:0}
</style>
<![endif]-->
</head>
<body>

<p>From <b>http://www.w3schools.com</b> (Copyright Refsnes Data)</p>

<h1>PHP <span class="color_h1">Database ODBC</span></h1>
<div class="chapter">
<div class="prev"><a class="chapter" href="php_mysql_delete.html">&laquo; Previous</a></div>
<div class="next"><a class="chapter" href="php_xml_parser_expat.html">Next Chapter &raquo;</a></div>
</div>
<hr />
<p class="intro">ODBC is an Application Programming Interface 
(API) that allows you to connect to a data source (e.g. an MS 
Access database).</p>
<hr />
<h2>Create an ODBC Connection</h2>

<p>With an ODBC connection, you can connect to any database, on any computer in 
your network, as long as an ODBC connection is available.</p>
<p>Here is how to create an ODBC connection to a MS Access Database:&nbsp;</p>
<ol>
  <li>Open the <b>Administrative Tools</b> icon in your Control Panel.</li>
  <li>Double-click on the <b>Data Sources (ODBC)</b> icon inside. </li>
  <li>Choose the <b>System DSN</b> tab. </li>
  <li>Click on <b>Add </b>in the System DSN tab. </li>
  <li>Select the <b>Microsoft Access Driver</b>. Click <b>Finish.</b> </li>
  <li>In the next screen, click <b>Select</b> to locate the database. </li>
  <li>Give the database a <b>Data Source Name (DSN)</b>. </li>
  <li>Click <b>OK</b>.</li>
</ol>
<p>Note that this configuration has to be done on the computer where your web 
site is located. If you are running Internet 
Information Server (IIS) on your own computer, the instructions above will work, 
but if your web site is located on a remote server, you have to have physical 
access to that server, or ask your web host to to set up a DSN for 
you to use.</p>
<hr />

<h2>Connecting to an ODBC</h2>
<p>The odbc_connect() function is used to connect to an ODBC data source. The function takes 
four parameters: the data source name, username, 
password, and an optional cursor type.</p>
<p>The odbc_exec() function is used to execute an SQL statement.</p>
<h3>Example</h3>
<p>The following example creates a connection to a DSN 
called northwind, with no username and no password. It then creates an SQL and 
executes it:</p>
<table class="code notranslate" cellspacing="0" cellpadding="0" border="0" width="100%">
<tr><td>
$conn=odbc_connect('northwind','','');<br />
$sql=&quot;SELECT * FROM customers&quot;;<br />
$rs=odbc_exec($conn,$sql);
</td></tr>
</table>
<br />
<hr />

<h2>Retrieving Records</h2>
<p>The odbc_fetch_row() function is used to return records from the result-set. This function returns true if it is able to return rows, otherwise 
false.</p>
<p>The function takes two parameters: the ODBC result identifier and an optional 
row number:</p>
<table class="code notranslate" cellspacing="0" cellpadding="0" border="0" width="100%">
<tr><td>
odbc_fetch_row($rs)
</td></tr>
</table>
<br />
<hr />

<h2>Retrieving Fields from a Record</h2>
<p>The odbc_result() function is used to read fields from a record. This function 
takes two parameters: the ODBC 
result identifier and a field number or name.</p>
<p>The code line below returns the value of the first field from the record: </p>
<table class="code notranslate" cellspacing="0" cellpadding="0" border="0" width="100%">
<tr><td>
$compname=odbc_result($rs,1);
</td></tr>
</table>

<p>The code line below returns the value of a field called &quot;CompanyName&quot;: </p>
<table class="code notranslate" cellspacing="0" cellpadding="0" border="0" width="100%">
<tr><td>
$compname=odbc_result($rs,&quot;CompanyName&quot;);
</td></tr>
</table>
<br />
<hr />

<h2>Closing an ODBC Connection</h2>
<p>The odbc_close() function is used to close an ODBC connection.</p>
<table class="code notranslate" cellspacing="0" cellpadding="0" border="0" width="100%">
<tr><td>
odbc_close($conn);
</td></tr>
</table>
<br />
<hr />

<h2>An ODBC Example</h2>
<p>The following example shows how to first create a database connection, then a 
result-set, and then display the data in an HTML table.</p>
<table class="code notranslate" cellspacing="0" cellpadding="0" border="0" width="100%">
<tr><td>
&lt;html&gt;<br />
&lt;body&gt;<br />
<br />
&lt;?php<br />
$conn=odbc_connect('northwind','','');<br />
if (!$conn)<br />
&nbsp;&nbsp;{exit(&quot;Connection Failed: &quot; . $conn);}<br />
$sql=&quot;SELECT * FROM customers&quot;;<br />
$rs=odbc_exec($conn,$sql);<br />
if (!$rs)<br />
&nbsp;&nbsp;{exit(&quot;Error in SQL&quot;);}<br />
echo &quot;&lt;table&gt;&lt;tr&gt;&quot;;<br />
echo &quot;&lt;th&gt;Companyname&lt;/th&gt;&quot;;<br />
echo &quot;&lt;th&gt;Contactname&lt;/th&gt;&lt;/tr&gt;&quot;;<br />
while (odbc_fetch_row($rs))<br />
&nbsp;&nbsp;{<br />
&nbsp;&nbsp;$compname=odbc_result($rs,&quot;CompanyName&quot;);<br />
&nbsp;&nbsp;$conname=odbc_result($rs,&quot;ContactName&quot;);<br />
&nbsp;&nbsp;echo &quot;&lt;tr&gt;&lt;td&gt;$compname&lt;/td&gt;&quot;;<br />
&nbsp;&nbsp;echo &quot;&lt;td&gt;$conname&lt;/td&gt;&lt;/tr&gt;&quot;;<br />
&nbsp;&nbsp;}<br />
odbc_close($conn);<br />
echo &quot;&lt;/table&gt;&quot;;<br />
?&gt;<br />
<br />
&lt;/body&gt;<br />
&lt;/html&gt;
</td></tr>
</table>
<br />
<div class="chapter">
<div class="prev"><a class="chapter" href="php_mysql_delete.html">&laquo; Previous</a></div>
<div class="next"><a class="chapter" href="php_xml_parser_expat.html">Next Chapter &raquo;</a></div>
</div>

<p>From <b>http://www.w3schools.com</b> (Copyright Refsnes Data)</p>

</body>

<!-- Mirrored from www.w3schools.com/php/php_db_odbc.asp?output=print by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 15 Oct 2011 23:20:37 GMT -->
</html>