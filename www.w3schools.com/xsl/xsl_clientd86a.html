<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-US" xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from www.w3schools.com/xsl/xsl_client.asp?output=print by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 15 Oct 2011 23:16:35 GMT -->
<head>

<title>XSLT on the Client</title>
 
<link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="Keywords" content="html,css,tutorial,html5,dhtml,css3,xsl,xslt,xhtml,javascript,jquery,asp,ado,net,vbscript,dom,sql,colors,soap,php,rss,authoring,programming,training,learning,quiz,beginner's guide,primer,lessons,school,howto,reference,examples,samples,source code,tags,demos,tips,links,FAQ,tag list,forms,frames,color table,w3c,cascading style sheets,active server pages,dynamic html,internet,database,development,Web building,Webmaster,html guide" />

<meta name="Description" content="Free HTML XHTML CSS JavaScript jQuery XML DOM XSL XSLT RSS AJAX ASP .NET PHP SQL tutorials, references, examples for web building." />

<link rel="stylesheet" type="text/css" href="../stdtheme.css" />
<script type="text/javascript">
<!--
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
//-->
</script>
<script type="text/javascript">
<!--
function searchfield_focus(obj)
{
obj.style.color=""
obj.style.fontStyle=""
if (obj.value=="Search w3schools.com")
	{
	obj.value=""
	}
}

var pageTracker = _gat._getTracker("UA-3855518-1");
pageTracker._initData();
pageTracker._trackPageview();

var addr=document.location.href;
function displayError()
{
document.getElementById("err_url").value=addr;
document.getElementById("err_form").style.display="block";
document.getElementById("err_desc").focus();
hideSent();
}
function hideError()
{
document.getElementById("err_form").style.display="none";
}
function hideSent()
{
document.getElementById("err_sent").style.display="none";
}
function sendErr()
{
var xmlhttp;
var err_url=document.getElementById("err_url").value;
var err_email=document.getElementById("err_email").value;
var err_desc=document.getElementById("err_desc").value;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }

xmlhttp.open("POST","../err_sup.html",true);
xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
xmlhttp.send("err_url=" + err_url + "&err_email=" + err_email + "&err_desc=" + escape(err_desc));
hideError();
document.getElementById("err_sent").style.display="block";
}

function click_expandingMenuHeader(obj,sectionName)
{
var x=document.getElementById("cssprop_" + sectionName).parentNode.className;
if (x.indexOf("expandingMenuNotSelected")>-1)
	{
	x=x.replace("expandingMenuNotSelected","expandingMenuSelected");
	document.getElementById("cssprop_" + sectionName).parentNode.className=x;
	document.getElementById("cssprop_" + sectionName).style.display="block";
	}
else
	{
	x=x.replace("expandingMenuSelected","expandingMenuNotSelected");
	document.getElementById("cssprop_" + sectionName).parentNode.className=x;
	document.getElementById("cssprop_" + sectionName).style.display="none";
	}
}

//-->
</script>
<!--[if lt IE 7]>
<style>
#leftcolumn{margin-left:0}
</style>
<![endif]-->
</head>
<body>

<p>From <b>http://www.w3schools.com</b> (Copyright Refsnes Data)</p>

<h1>XSLT - <span class="color_h1">On the Client</span></h1>
<div class="chapter">
<div class="prev"><a class="chapter" href="xsl_apply_templates.html">&laquo; Previous</a></div>
<div class="next"><a class="chapter" href="xsl_server.html">Next Chapter &raquo;</a></div>
</div>
<hr />
<p class="intro">If your browser supports it, XSLT can be used to transform the document to XHTML in your browser.</p>
<hr />

<h2>A JavaScript Solution</h2>
In the previous chapters we have explained how XSLT can be used to transform a document
from XML to XHTML. We did this by adding an XSL style sheet to the XML
file and let the browser do the transformation.<p>Even if this works fine, it is not always desirable to include a style sheet reference in 
an XML file (e.g. it will not work in a non XSLT aware browser.)</p>
<p>A more versatile solution would be to use a JavaScript to do the transformation.</p>
<p>By using a JavaScript, we can:</p>
<ul>
  <li>do browser-specific testing</li>
  <li>use different style sheets according to browser and user
    needs</li>
</ul>
<p>That is the beauty of XSLT! One of the design goals for XSLT was to make it 
possible to transform data from one format to another, supporting different 
browsers and different user needs.</p>
<p>XSLT transformation on the client side is bound to be a major part of the
browsers work tasks in the future, as we will see a growth in the specialized
browser market (Braille, aural browsers, Web printers, handheld devices, etc.)
</p>
<hr />

<h2>The XML File and the XSL File</h2>
<p>Look at the XML document that you have seen in the previous chapters:</p>

<table class="code notranslate" cellspacing="0" cellpadding="0" border="0" width="100%">
<tr><td>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;<br />
&lt;catalog&gt;<br />
  &nbsp;
  &lt;cd&gt;<br />
    &nbsp;&nbsp;&nbsp;
    &lt;title&gt;Empire Burlesque&lt;/title&gt;<br />
    &nbsp;&nbsp;&nbsp;
    &lt;artist&gt;Bob Dylan&lt;/artist&gt;<br />
    &nbsp;&nbsp;&nbsp;
    &lt;country&gt;USA&lt;/country&gt;<br />
    &nbsp;&nbsp;&nbsp;
    &lt;company&gt;Columbia&lt;/company&gt;<br />
    &nbsp;&nbsp;&nbsp;
    &lt;price&gt;10.90&lt;/price&gt;<br />
    &nbsp;&nbsp;&nbsp;
    &lt;year&gt;1985&lt;/year&gt;<br />
  &nbsp;
  &lt;/cd&gt;<br />
.<br />
.<br />
&lt;/catalog&gt;</td></tr>
</table>

<p><a target="_blank" href="cdcatalog.xml">View the XML file</a>.</p>
<p>And the accompanying XSL style sheet:</p>

<table class="code notranslate" cellspacing="0" cellpadding="0" border="0" width="100%">
<tr><td>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;<br />
&lt;xsl:stylesheet version=&quot;1.0&quot;<br />
xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt;<br /><br />
&lt;xsl:template match=&quot;/&quot;&gt;<br />
  &nbsp;
  &lt;html&gt;<br />
  &nbsp;
  &lt;body&gt;<br />
    &nbsp;
    &lt;h2&gt;My CD Collection&lt;/h2&gt;<br />
    &nbsp;
    &lt;table border=&quot;1&quot;&gt;<br />
      &nbsp;&nbsp;&nbsp;
      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        &lt;th align=&quot;left&quot;&gt;Title&lt;/th&gt;<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        &lt;th align=&quot;left&quot;&gt;Artist&lt;/th&gt;<br />
      &nbsp;&nbsp;&nbsp;
      &lt;/tr&gt;<br />
      &nbsp;&nbsp;&nbsp;
      &lt;xsl:for-each select=&quot;catalog/cd&quot;&gt;<br />
      &nbsp;&nbsp;&nbsp;
      &lt;tr&gt;<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        &lt;td&gt;&lt;xsl:value-of select=&quot;title&quot; /&gt;&lt;/td&gt;<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        &lt;td&gt;&lt;xsl:value-of select=&quot;artist&quot; /&gt;&lt;/td&gt;<br />
      &nbsp;&nbsp;&nbsp;
      &lt;/tr&gt;<br />
      &nbsp;&nbsp;&nbsp;
      &lt;/xsl:for-each&gt;<br />
  &nbsp;
  &lt;/table&gt;<br />
  &nbsp;
  &lt;/body&gt;<br />
  &nbsp;
  &lt;/html&gt;<br />
&lt;/xsl:template&gt;<br /><br />
&lt;/xsl:stylesheet&gt;</td></tr>
</table>

<p><a target="_blank" href="cdcatalog.xsl">View the XSL file</a>.</p>
<p><b>Notice that the XML file does not have a reference to the XSL file.</b></p>
<p><b>IMPORTANT:</b> The above sentence indicates that an XML file could be transformed using many different XSL style sheets.</p>
<hr />

<h2>Transforming XML to XHTML in the Browser</h2>
<p>Here is the source code needed to transform the XML file to XHTML on the client:</p>

<table class="example" border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td>
<h2 class="example">Example</h2>
<table class="example_code notranslate" border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td>
&lt;html&gt;<br />
&lt;head&gt;<br />
&lt;script&gt;<br />
function loadXMLDoc(dname)<br />
{<br />
if (window.XMLHttpRequest)<br />
&nbsp; {<br />
&nbsp; xhttp=new XMLHttpRequest();<br />
&nbsp; }<br />
else<br />
&nbsp; {<br />
&nbsp; xhttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);<br />
&nbsp; }<br />
xhttp.open(&quot;GET&quot;,dname,false);<br />
xhttp.send(&quot;&quot;);<br />
return xhttp.responseXML;<br />
}<br />
<br />
function displayResult()<br />
{<br />
xml=loadXMLDoc(&quot;cdcatalog.xml&quot;);<br />
xsl=loadXMLDoc(&quot;cdcatalog.xsl&quot;);<br />
// code for IE<br />
if (window.ActiveXObject)<br />
&nbsp; {<br />
&nbsp; ex=xml.transformNode(xsl);<br />
&nbsp; document.getElementById(&quot;example&quot;).innerHTML=ex;<br />
&nbsp; }<br />
// code for Mozilla, Firefox, Opera, etc.<br />
else if (document.implementation &amp;&amp; document.implementation.createDocument)<br />
&nbsp; {<br />
&nbsp; xsltProcessor=new XSLTProcessor();<br />
&nbsp; xsltProcessor.importStylesheet(xsl);<br />
&nbsp; resultDocument = xsltProcessor.transformToFragment(xml,document);<br />
&nbsp; document.getElementById(&quot;example&quot;).appendChild(resultDocument);<br />
&nbsp; }<br />
}<br />
&lt;/script&gt;<br />
&lt;/head&gt;<br />
&lt;body onload=&quot;displayResult()&quot;&gt;<br />
&lt;div id=&quot;example&quot; /&gt;<br />
&lt;/body&gt;<br />
&lt;/html&gt;</td></tr></table>
<br /><a target="_blank" href="tryit1232.html?filename=cdcatalog" class="tryitbtn">Try it yourself &raquo;</a>
</td></tr></table>
<p><b>Tip:</b> If you don't know how to write JavaScript, you can study our <a href="../js/default.html">JavaScript tutorial</a>.</p>

<h2>Example Explained:</h2>
<p><b>The loadXMLDoc() Function</b></p>
<p>The loadXMLDoc() function is used to load the XML and XSL 
files.</p>
<p>It checks what kind of browser the user has and loads the file.</p>
<p><b>The displayResult() Function</b></p>
<p>This function is used to display the XML file styled by the XSL file.</p>
<ul>
	<li>Load XML and XSL file</li>
	<li>Test what kind of browser the user has</li>
	<li>If the user has a browser supporting the ActiveX object:<ul>
		<li>Use the transformNode() method to apply the XSL style sheet to the 
		xml document</li>
		<li>Set the body of the current document (id=&quot;example&quot;) to contain the 
		styled xml document</li>
	</ul>
	</li>
	<li>If the user has a browser that does not support the ActiveX object:<ul>
		<li>Create a new XSLTProcessor object and import the XSL file to it</li>
		<li>Use the transformToFragment() method to apply the XSL style sheet to 
		the xml document</li>
		<li>Set the body of the current document (id=&quot;example&quot;) to contain the 
		styled xml document</li>
	</ul>
	</li>
</ul>
<br />
<div class="chapter">
<div class="prev"><a class="chapter" href="xsl_apply_templates.html">&laquo; Previous</a></div>
<div class="next"><a class="chapter" href="xsl_server.html">Next Chapter &raquo;</a></div>
</div>

<p>From <b>http://www.w3schools.com</b> (Copyright Refsnes Data)</p>

</body>

<!-- Mirrored from www.w3schools.com/xsl/xsl_client.asp?output=print by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 15 Oct 2011 23:16:35 GMT -->
</html>