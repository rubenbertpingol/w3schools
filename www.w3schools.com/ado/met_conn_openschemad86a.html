<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-US" xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from www.w3schools.com/ado/met_conn_openschema.asp?output=print by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 15 Oct 2011 23:50:07 GMT -->
<head>

<title>ADO OpenSchema Method</title>
 
<link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="Keywords" content="html,css,tutorial,html5,dhtml,css3,xsl,xslt,xhtml,javascript,jquery,asp,ado,net,vbscript,dom,sql,colors,soap,php,rss,authoring,programming,training,learning,quiz,beginner's guide,primer,lessons,school,howto,reference,examples,samples,source code,tags,demos,tips,links,FAQ,tag list,forms,frames,color table,w3c,cascading style sheets,active server pages,dynamic html,internet,database,development,Web building,Webmaster,html guide" />

<meta name="Description" content="Free HTML XHTML CSS JavaScript jQuery XML DOM XSL XSLT RSS AJAX ASP .NET PHP SQL tutorials, references, examples for web building." />

<link rel="stylesheet" type="text/css" href="../stdtheme.css" />
<script type="text/javascript">
<!--
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
//-->
</script>
<script type="text/javascript">
<!--
function searchfield_focus(obj)
{
obj.style.color=""
obj.style.fontStyle=""
if (obj.value=="Search w3schools.com")
	{
	obj.value=""
	}
}

var pageTracker = _gat._getTracker("UA-3855518-1");
pageTracker._initData();
pageTracker._trackPageview();

var addr=document.location.href;
function displayError()
{
document.getElementById("err_url").value=addr;
document.getElementById("err_form").style.display="block";
document.getElementById("err_desc").focus();
hideSent();
}
function hideError()
{
document.getElementById("err_form").style.display="none";
}
function hideSent()
{
document.getElementById("err_sent").style.display="none";
}
function sendErr()
{
var xmlhttp;
var err_url=document.getElementById("err_url").value;
var err_email=document.getElementById("err_email").value;
var err_desc=document.getElementById("err_desc").value;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }

xmlhttp.open("POST","../err_sup.html",true);
xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
xmlhttp.send("err_url=" + err_url + "&err_email=" + err_email + "&err_desc=" + escape(err_desc));
hideError();
document.getElementById("err_sent").style.display="block";
}

function click_expandingMenuHeader(obj,sectionName)
{
var x=document.getElementById("cssprop_" + sectionName).parentNode.className;
if (x.indexOf("expandingMenuNotSelected")>-1)
	{
	x=x.replace("expandingMenuNotSelected","expandingMenuSelected");
	document.getElementById("cssprop_" + sectionName).parentNode.className=x;
	document.getElementById("cssprop_" + sectionName).style.display="block";
	}
else
	{
	x=x.replace("expandingMenuSelected","expandingMenuNotSelected");
	document.getElementById("cssprop_" + sectionName).parentNode.className=x;
	document.getElementById("cssprop_" + sectionName).style.display="none";
	}
}

//-->
</script>
<!--[if lt IE 7]>
<style>
#leftcolumn{margin-left:0}
</style>
<![endif]-->
</head>
<body>

<p>From <b>http://www.w3schools.com</b> (Copyright Refsnes Data)</p>


<h1>ADO <span class="color_h1">OpenSchema</span> Method</h1>
<hr />
<a href="ado_ref_connection.html"><img class="navup" src="http://www.w3schools.com/images/up.gif" alt="Connection Object Reference" border="0" /> Complete Connection Object Reference</a>
<hr />
<p>The OpenSchema method returns a Recordset object with schema information from
the provider about the data source. For example, schema information can include
the names of the tables, names of the columns in the tables, and the data type
of each column. The Recordset will be opened as a read-only recordset.
</p>

<h3>Syntax
</h3>

<table class="code notranslate" cellspacing="0" cellpadding="0" border="0" width="100%">
<tr><td>Set rs=objconn.OpenSchema(querytype,criteria,schemaid)</td></tr>
</table>
<br />
<table class="reference"> 
  <tr>
    <th align="left" valign="top" width="20%">Parameter</th>
    <th align="left" valign="top" width="80%">Description</th>
  </tr>  
  <tr>
    <td valign="top">querytype </td>
    <td valign="top">   Required. A <a href="#schemaenum">SchemaEnum</a>
      value that represents the type of schema query to run<p><b>Note:</b> The
      OLEDB specification only require 3 of the SchemaEnum values to be
      supported. These are adSchemaTables, adSchemaColumns, and the adSchemaProviderTypes
</p>

    </td>
  </tr>
  <tr>
    <td valign="top">criteria </td>
    <td valign="top">   Optional. An array of query constraints for each
      querytype
      option, as listed in <a href="#schemaenum"> SchemaEnum</a>      
    </td>
  </tr>
  <tr>
    <td valign="top">schemaid </td>
    <td valign="top">   The GUID for a provider-schema query not defined by the OLE DB specification.
      Required if querytype is set to adSchemaProviderSpecific      
    </td>
  </tr>
</table>

<br />
<hr />
<a name="schemaenum"><h3>SchemaEnum Values</h3></a>
<table class="reference">
      <tr>
        <th valign="top" align="left">Constant</th>
        <th valign="top" align="left">Value</th>
        <th valign="top" align="left">Description</th>
        <th valign="top" align="left">Constraint Columns</th>
      </tr>
      <tr>
        <td valign="top">adSchemaProviderSpecific</td>
        <td valign="top">-1</td>
        <td valign="top">Used if the provider defines its own nonstandard schema
          queries</td>
        <td valign="top">Provider specific</td>
      </tr>
      <tr>
        <td valign="top">adSchemaAsserts</td>
        <td valign="top">0</td>
        <td valign="top">Returns the assertions defined in the catalog
        </td>
        <td valign="top">CONSTRAINT_CATALOG<br />
          CONSTRAINT_SCHEMA<br />
          CONSTRAINT_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaCatalogs</td>
        <td valign="top">1</td>
        <td valign="top">Returns the physical attributes associated with catalogs
          accessible from the DBMS
        </td>
        <td valign="top">CATALOG_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaCharacterSets</td>
        <td valign="top">2</td>
        <td valign="top">Returns the character sets defined in the catalog
        </td>
        <td valign="top">CHARACTER_SET_CATALOG<br />
          CHARACTER_SET_SCHEMA<br />
          CHARACTER_SET_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaCollations</td>
        <td valign="top">3</td>
        <td valign="top">Returns the character collations defined in the catalog
        </td>
        <td valign="top">COLLATION_CATALOG<br />
          COLLATION_SCHEMA<br />
          COLLATION_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaColumns</td>
        <td valign="top">4</td>
        <td valign="top">Returns the columns of tables defined
          in the catalog
        </td>
        <td valign="top">TABLE_CATALOG<br />
          TABLE_SCHEMA<br />
          TABLE_NAME<br />
          COLUMN_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaCheckConstraints</td>
        <td valign="top">5</td>
        <td valign="top">Returns the check constraints defined in the catalog
        </td>
        <td valign="top">CONSTRAINT_CATALOG<br />
          CONSTRAINT_SCHEMA<br />
          CONSTRAINT_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaConstraintColumnUsage</td>
        <td valign="top">6</td>
        <td valign="top">Returns the columns used by referential constraints,
          unique constraints, check constraints, and assertions, defined in the
          catalog
        </td>
        <td valign="top">TABLE_CATALOG<br />
          TABLE_SCHEMA<br />
          TABLE_NAME<br />
          COLUMN_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaConstraintTableUsage</td>
        <td valign="top">7</td>
        <td valign="top">Returns the tables that are used by referential
          constraints, unique constraints, check constraints, and assertions
          defined in the catalog
        </td>
        <td valign="top">TABLE_CATALOG<br />
          TABLE_SCHEMA<br />
          TABLE_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaKeyColumnUsage</td>
        <td valign="top">8</td>
        <td valign="top">Returns the columns defined in the catalog that are
          constrained as keys
        </td>
        <td valign="top">CONSTRAINT_CATALOG<br />
          CONSTRAINT_SCHEMA<br />
          CONSTRAINT_NAME<br />
          TABLE_CATALOG<br />
          TABLE_SCHEMA<br />
          TABLE_NAME<br />
          COLUMN_NAME</td>
      </tr>
      <tr>
        <td valign="top">AdSchemaReferentialConstraints</td>
        <td valign="top">9</td>
        <td valign="top">Returns the referential constraints defined in the
          catalog
        </td>
        <td valign="top">CONSTRAINT_CATALOG<br />
          CONSTRAINT_SCHEMA<br />
          CONSTRAINT_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaTableConstraints</td>
        <td valign="top">10</td>
        <td valign="top">Returns the table constraints defined in the catalog
        </td>
        <td valign="top">CONSTRAINT_CATALOG<br />
          CONSTRAINT_SCHEMA<br />
          CONSTRAINT_NAME<br />
          TABLE_CATALOG<br />
          TABLE_SCHEMA<br />
          TABLE_NAME<br />
          CONSTRAINT_TYPE</td>
      </tr>
      <tr>
        <td valign="top">adSchemaColumnsDomainUsage</td>
        <td valign="top">11</td>
        <td valign="top">Returns the columns defined in the catalog that are
          dependent on a domain defined in the catalog
        </td>
        <td valign="top">DOMAIN_CATALOG<br />
          DOMAIN_SCHEMA<br />
          DOMAIN_NAME<br />
          COLUMN_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaIndexes</td>
        <td valign="top">12</td>
        <td valign="top">Returns the indexes defined in the catalog
        </td>
        <td valign="top">TABLE_CATALOG<br />
          TABLE_SCHEMA<br />
          INDEX_NAME<br />
          TYPE<br />
          TABLE_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaColumnPrivileges</td>
        <td valign="top">13</td>
        <td valign="top">Returns the privileges on columns of tables defined in
          the catalog
        </td>
        <td valign="top">TABLE_CATALOG<br />
          TABLE_SCHEMA<br />
          TABLE_NAME<br />
          COLUMN_NAME<br />
          GRANTOR<br />
          GRANTEE</td>
      </tr>
      <tr>
        <td valign="top">adSchemaTablePrivileges</td>
        <td valign="top">14</td>
        <td valign="top">Returns the privileges on tables defined in the catalog
        </td>
        <td valign="top">TABLE_CATALOG<br />
          TABLE_SCHEMA<br />
          TABLE_NAME<br />
          GRANTOR<br />
          GRANTEE</td>
      </tr>
      <tr>
        <td valign="top">adSchemaUsagePrivileges</td>
        <td valign="top">15</td>
        <td valign="top">Returns the USAGE privileges on objects defined in the
          catalog
        </td>
        <td valign="top">OBJECT_CATALOG<br />
          OBJECT_SCHEMA<br />
          OBJECT_NAME<br />
          OBJECT_TYPE<br />
          GRANTOR<br />
          GRANTEE</td>
      </tr>
      <tr>
        <td valign="top">adSchemaProcedures</td>
        <td valign="top">16</td>
        <td valign="top">Returns the procedures defined in the catalog
        </td>
        <td valign="top">PROCEDURE_CATALOG<br />
          PROCEDURE_SCHEMA<br />
          PROCEDURE_NAME<br />
          PROCEDURE_TYPE</td>
      </tr>
      <tr>
        <td valign="top">adSchemaSchemata</td>
        <td valign="top">17</td>
        <td valign="top">Returns the schemas (database objects)
        </td>
        <td valign="top">CATALOG_NAME<br />
          SCHEMA_NAME<br />
          SCHEMA_OWNER</td>
      </tr>
      <tr>
        <td valign="top">adSchemaSQLLanguages</td>
        <td valign="top">18</td>
        <td valign="top">Returns the conformance levels, options, and dialects
          supported by the SQL-implementation processing data defined in the
          catalog.
        </td>
        <td valign="top">None</td>
      </tr>
      <tr>
        <td valign="top">adSchemaStatistics</td>
        <td valign="top">19</td>
        <td valign="top">Returns the statistics defined in the catalog
        </td>
        <td valign="top">TABLE_CATALOG<br />
          TABLE_SCHEMA<br />
          TABLE_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaTables</td>
        <td valign="top">20</td>
        <td valign="top">Returns the tables defined in the
          catalog that are accessible
        </td>
        <td valign="top">TABLE_CATALOG<br />
          TABLE_SCHEMA<br />
          TABLE_NAME<br />
          TABLE_TYPE</td>
      </tr>
      <tr>
        <td valign="top">adSchemaTranslations</td>
        <td valign="top">21</td>
        <td valign="top">Returns the character translations defined in the
          catalog that are accessible
        </td>
        <td valign="top">TRANSLATION_CATALOG<br />
          TRANSLATION_SCHEMA<br />
          TRANSLATION_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaProviderTypes</td>
        <td valign="top">22</td>
        <td valign="top">Returns the data types supported by the data provider
        </td>
        <td valign="top">DATA_TYPE<br />
          BEST_MATCH</td>
      </tr>
      <tr>
        <td valign="top">adSchemaViews</td>
        <td valign="top">23</td>
        <td valign="top">Returns the views defined in the catalog that are
          accessible
        </td>
        <td valign="top">TABLE_CATALOG<br />
          TABLE_SCHEMA<br />
          TABLE_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaViewColumnUsage</td>
        <td valign="top">24</td>
        <td valign="top">Returns the columns on which viewed tables, are
          dependent
        </td>
        <td valign="top">VIEW_CATALOG<br />
          VIEW_SCHEMA<br />
          VIEW_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaViewTableUsage</td>
        <td valign="top">25</td>
        <td valign="top">Returns the tables on which viewed tables, are
          dependent
        </td>
        <td valign="top">VIEW_CATALOG<br />
          VIEW_SCHEMA<br />
          VIEW_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaProcedureParameters</td>
        <td valign="top">26</td>
        <td valign="top">Returns info about the parameters and return
          codes of procedures
        </td>
        <td valign="top">PROCEDURE_CATALOG<br />
          PROCEDURE_SCHEMA<br />
          PROCEDURE_NAME<br />
          PARAMETER_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaForeignKeys</td>
        <td valign="top">27</td>
        <td valign="top">Returns the foreign key columns defined in the catalog
        </td>
        <td valign="top">PK_TABLE_CATALOG<br />
          PK_TABLE_SCHEMA<br />
          PK_TABLE_NAME<br />
          FK_TABLE_CATALOG<br />
          FK_TABLE_SCHEMA<br />
          FK_TABLE_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaPrimaryKeys</td>
        <td valign="top">28</td>
        <td valign="top">Returns the primary key columns defined in the catalog
        </td>
        <td valign="top">PK_TABLE_CATALOG<br />
          PK_TABLE_SCHEMA<br />
          PK_TABLE_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaProcedureColumns</td>
        <td valign="top">29</td>
        <td valign="top">Returns info about the columns of rowsets
          returned by procedures
        </td>
        <td valign="top">PROCEDURE_CATALOG<br />
          PROCEDURE_SCHEMA<br />
          PROCEDURE_NAME<br />
          COLUMN_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaDBInfoKeywords</td>
        <td valign="top">30</td>
        <td valign="top">Returns a list of provider-specific keywords
        </td>
        <td valign="top">None</td>
      </tr>
      <tr>
        <td valign="top">adSchemaDBInfoLiterals</td>
        <td valign="top">31</td>
        <td valign="top">Returns a list of provider-specific literals used in
          text commands
        </td>
        <td valign="top">None</td>
      </tr>
      <tr>
        <td valign="top">adSchemaCubes</td>
        <td valign="top">32</td>
        <td valign="top">Returns info about the available cubes in a
          schema
        </td>
        <td valign="top">CATALOG_NAME<br />
          SCHEMA_NAME<br />
          CUBE_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaDimensions</td>
        <td valign="top">33</td>
        <td valign="top">Returns info about the dimensions in a given cube
        </td>
        <td valign="top">CATALOG_NAME<br />
          SCHEMA_NAME<br />
          CUBE_NAME<br />
          DIMENSION_NAME<br />
          DIMENSION_UNIQUE_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaHierarchies</td>
        <td valign="top">34</td>
        <td valign="top">Returns info about the hierarchies available in a
          dimension
        </td>
        <td valign="top">CATALOG_NAME<br />
          SCHEMA_NAME<br />
          CUBE_NAME<br />
          DIMENSION_UNIQUE_NAME<br />
          HIERARCHY_NAME<br />
          HIERARCHY_UNIQUE_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaLevels</td>
        <td valign="top">35</td>
        <td valign="top">Returns info about the levels available in a dimension
        </td>
        <td valign="top">CATALOG_NAME<br />
          SCHEMA_NAME<br />
          CUBE_NAME<br />
          DIMENSION_UNIQUE_NAME<br />
          HIERARCHY_UNIQUE_NAME<br />
          LEVEL_NAME<br />
          LEVEL_UNIQUE_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaMeasures</td>
        <td valign="top">36</td>
        <td valign="top">Returns info about the available measures
        </td>
        <td valign="top">CATALOG_NAME<br />
          SCHEMA_NAME<br />
          CUBE_NAME<br />
          MEASURE_NAME<br />
          MEASURE_UNIQUE_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaProperties</td>
        <td valign="top">37</td>
        <td valign="top">Returns info about the available properties for
          each level of the dimension
        </td>
        <td valign="top">CATALOG_NAME<br />
          SCHEMA_NAME<br />
          CUBE_NAME<br />
          DIMENSION_UNIQUE_NAME<br />
          HIERARCHY_UNIQUE_NAME<br />
          LEVEL_UNIQUE_NAME<br />
          MEMBER_UNIQUE_NAME<br />
          PROPERTY_TYPE<br />
          PROPERTY_NAME</td>
      </tr>
      <tr>
        <td valign="top">adSchemaMembers</td>
        <td valign="top">38</td>
        <td valign="top">Returns info about the available members
        </td>
        <td valign="top">CATALOG_NAME<br />
          SCHEMA_NAME<br />
          CUBE_NAME<br />
          DIMENSION_UNIQUE_NAME<br />
          HIERARCHY_UNIQUE_NAME<br />
          LEVEL_UNIQUE_NAME<br />
          LEVEL_NUMBER<br />
          MEMBER_NAME<br />
          MEMBER_UNIQUE_NAME<br />
          MEMBER_CAPTION<br />
          MEMBER_TYPE<br />
          TREE OPERATOR</td>
      </tr>
      <tr>
        <td valign="top">adSchemaTrustees</td>
        <td valign="top">39</td>
        <td valign="top">For future use</td>
        <td valign="top">None</td>
      </tr>
  </table>
<br />
<hr />
<a href="ado_ref_connection.html"><img class="navup" src="http://www.w3schools.com/images/up.gif" alt="Connection Object Reference" border="0" /> Complete Connection Object Reference</a>

<p>From <b>http://www.w3schools.com</b> (Copyright Refsnes Data)</p>

</body>

<!-- Mirrored from www.w3schools.com/ado/met_conn_openschema.asp?output=print by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 15 Oct 2011 23:50:07 GMT -->
</html>