<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-US" xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from www.w3schools.com/ado/ev_conn_execute.asp?output=print by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 15 Oct 2011 23:50:07 GMT -->
<head>

<title>ADO WillExecute and ExecuteComplete Events</title>
 
<link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="Keywords" content="html,css,tutorial,html5,dhtml,css3,xsl,xslt,xhtml,javascript,jquery,asp,ado,net,vbscript,dom,sql,colors,soap,php,rss,authoring,programming,training,learning,quiz,beginner's guide,primer,lessons,school,howto,reference,examples,samples,source code,tags,demos,tips,links,FAQ,tag list,forms,frames,color table,w3c,cascading style sheets,active server pages,dynamic html,internet,database,development,Web building,Webmaster,html guide" />

<meta name="Description" content="Free HTML XHTML CSS JavaScript jQuery XML DOM XSL XSLT RSS AJAX ASP .NET PHP SQL tutorials, references, examples for web building." />

<link rel="stylesheet" type="text/css" href="../stdtheme.css" />
<script type="text/javascript">
<!--
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
//-->
</script>
<script type="text/javascript">
<!--
function searchfield_focus(obj)
{
obj.style.color=""
obj.style.fontStyle=""
if (obj.value=="Search w3schools.com")
	{
	obj.value=""
	}
}

var pageTracker = _gat._getTracker("UA-3855518-1");
pageTracker._initData();
pageTracker._trackPageview();

var addr=document.location.href;
function displayError()
{
document.getElementById("err_url").value=addr;
document.getElementById("err_form").style.display="block";
document.getElementById("err_desc").focus();
hideSent();
}
function hideError()
{
document.getElementById("err_form").style.display="none";
}
function hideSent()
{
document.getElementById("err_sent").style.display="none";
}
function sendErr()
{
var xmlhttp;
var err_url=document.getElementById("err_url").value;
var err_email=document.getElementById("err_email").value;
var err_desc=document.getElementById("err_desc").value;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }

xmlhttp.open("POST","../err_sup.html",true);
xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
xmlhttp.send("err_url=" + err_url + "&err_email=" + err_email + "&err_desc=" + escape(err_desc));
hideError();
document.getElementById("err_sent").style.display="block";
}

function click_expandingMenuHeader(obj,sectionName)
{
var x=document.getElementById("cssprop_" + sectionName).parentNode.className;
if (x.indexOf("expandingMenuNotSelected")>-1)
	{
	x=x.replace("expandingMenuNotSelected","expandingMenuSelected");
	document.getElementById("cssprop_" + sectionName).parentNode.className=x;
	document.getElementById("cssprop_" + sectionName).style.display="block";
	}
else
	{
	x=x.replace("expandingMenuSelected","expandingMenuNotSelected");
	document.getElementById("cssprop_" + sectionName).parentNode.className=x;
	document.getElementById("cssprop_" + sectionName).style.display="none";
	}
}

//-->
</script>
<!--[if lt IE 7]>
<style>
#leftcolumn{margin-left:0}
</style>
<![endif]-->
</head>
<body>

<p>From <b>http://www.w3schools.com</b> (Copyright Refsnes Data)</p>


<h1>ADO <span class="color_h1">WillExecute</span> and 
<span class="color_h1">ExecuteComplete</span> Events</h1>
<hr />
<a href="ado_ref_connection.html"><img class="navup" src="http://www.w3schools.com/images/up.gif" alt="Connection Object Reference" border="0" /> Complete Connection Object Reference</a>
<hr />
<p>An event is a subroutine that can be called automatically after a specific
operation has occurred.
</p>

<ul>
  <li>The <b>WillExecute</b> event can be fired just before a call to
    objcomm.Execute, objconn.Execute, or objrs.Open.</li>
  <li>The <b> ExecuteComplete</b> event can be fired after a call to objcomm.Execute,
objconn.Execute, objrs.Open, objrs.Requery, or objrs.NextRecordset is completed.</li>
</ul>

<h3>Syntax
</h3>

<table class="code notranslate" cellspacing="0" cellpadding="0" border="0" width="100%">
<tr><td>
WillExecute src,cursortyp,locktyp,options,<br />
status,objcomm,objrs,objconn<br />
<br />
ExecuteComplete recaffected,objerror,status,<br />
objcomm,objrs,objconn
</td></tr>
</table>
<br />
<table class="reference">
  <tr>
    <th align="left" valign="top" width="20%">Parameter</th>
    <th align="left" valign="top" width="80%">Description</th>
  </tr>  
  <tr>
    <td valign="top">src </td>
    <td valign="top">   A string that contains an SQL command or a stored procedure name      
    </td>
  </tr>
  <tr>
    <td valign="top">cursortyp </td>
    <td valign="top">   Specifies the type of cursor to be used. One of the <a href="#cursortypeenum">CursorTypeEnum</a>
      values      
    </td>
  </tr>
  <tr>
    <td valign="top">locktyp </td>
    <td valign="top">   Specifies the type of lock to be used. One of the <a href="#locktypeenum">LockTypeEnum</a>
      values      
    </td>
  </tr>
  <tr>
    <td valign="top">options </td>
    <td valign="top">   One or more of the <a href="#commandtypeenum"> CommandTypeEnum</a> or
      <a href="#executeoptionenum"> ExecuteOptionEnum</a> values      
    </td>
  </tr>
  <tr>
    <td valign="top">recaffected </td>
    <td valign="top">   The number of records affected by the execution      
    </td>
  </tr>
  <tr>
    <td valign="top">objerror </td>
    <td valign="top">   An Error object that contains the errors that occurred
      <p><b>Note:</b> The EventStatusEnum value must be set to
      adStatusErrorsOccurred to create the Error object      
    </td>
  </tr>
  <tr>
    <td valign="top">status </td>
    <td valign="top">   An <a href="#eventstatusenum">EventStatusEnum</a> value      
    </td>
  </tr>
  <tr>
    <td valign="top">objcomm </td>
    <td valign="top">   For <b>WillExecute</b>: Set to the Command object that was executed or to
      Nothing
      <p>For <b>ExecuteComplete</b>:   The Command object that was executed</p>
    </td>
  </tr>
  <tr>
    <td valign="top">objrs </td>
    <td valign="top">   For <b>WillExecute</b>: Set to the Recordset object that resulted from the execution of the command or to
      Nothing
      <p>For <b>ExecuteComplete</b>:   The Recordset object that is the result of the executed
      command</p>
    </td>
  </tr>
  <tr>
    <td valign="top">objconn </td>
    <td valign="top">   The Connection object that is associated with the execution of the
      command      
    </td>
  </tr>
</table>
<br />
<hr />
<a name="cursortypeenum"><h3>CursorTypeEnum Values</h3></a>
<p>Specifies the type of cursor used in a Recordset object.</p>
<table class="reference">
    <tr valign="top" align="left">
      <th width="30%">Constant</th>
      <th width="10%">Value</th>
      <th width="60%">Description</th>
    </tr>
    <tr valign="top">
      <td>adOpenUnspecified</td>
      <td>-1</td>
      <td>Does not specify the type of cursor.</td>
    </tr>
    <tr valign="top">
      <td>adOpenForwardOnly</td>
      <td>0</td>
      <td>Default. Uses a forward-only cursor. Identical to a static cursor,
        except that you can only scroll forward through records. This improves
        performance when you need to make only one pass through a Recordset.</td>
    </tr>
    <tr valign="top">
      <td>adOpenKeyset</td>
      <td>1</td>
      <td>Uses a keyset cursor. Like a dynamic cursor, except that you can't see
        records that other users add, although records that other users delete
        are inaccessible from your Recordset. Data changes by other users are
        still visible.</td>
    </tr>
    <tr valign="top">
      <td>adOpenDynamic</td>
      <td>2</td>
      <td>Uses a dynamic cursor. Additions, changes, and deletions by other
        users are visible, and all types of movement through the Recordset are
        allowed, except for bookmarks, if the provider doesn't support them.</td>
    </tr>
    <tr valign="top">
      <td>adOpenStatic</td>
      <td>3</td>
      <td>Uses a static cursor. A static copy of a set of records that you can
        use to find data or generate reports. Additions, changes, or deletions
        by other users are not visible.</td>
    </tr>
</table>
<br />
<hr />
<a name="locktypeenum"><h3>LockTypeEnum Values</h3></a>
<table class="reference">
    <tr valign="top" align="left">
      <th width="30%">Constant</th>
      <th width="10%">Value</th>
      <th width="60%">Description</th>
    </tr>
    <tr valign="top">
      <td>adLockUnspecified</td>
      <td>-1</td>
      <td>Does not specify a type of lock. For clones, the clone is created with
        the same lock type as the original.</td>
    </tr>
    <tr valign="top">
      <td>adLockReadOnly</td>
      <td>1</td>
      <td>Indicates read-only records. You cannot alter the data.</td>
    </tr>
    <tr valign="top">
      <td>adLockPessimistic</td>
      <td>2</td>
      <td>Indicates pessimistic locking, record by record. The provider does
        what is necessary to ensure successful editing of the records, usually
        by locking records at the data source immediately after editing.</td>
    </tr>
    <tr valign="top">
      <td>adLockOptimistic</td>
      <td>3</td>
      <td>Indicates optimistic locking, record by record. The provider uses
        optimistic locking, locking records only when you call the Update
        method.</td>
    </tr>
    <tr valign="top">
      <td>adLockBatchOptimistic</td>
      <td>4</td>
      <td>Indicates optimistic batch updates. Required for batch update mode.</td>
    </tr>
</table>
<br />
<hr />
<a name="commandtypeenum"><h3>CommandTypeEnum Values</h3></a>
<table class="reference">
    <tr valign="top" align="left">
      <th width="30%">Constant</th>
      <th width="10%">Value</th>
      <th width="60%">Description</th>
    </tr>
    <tr valign="top">
      <td>adCmdUnspecified</td>
      <td>-1</td>
      <td>Does not specify the command type argument.</td>
    </tr>
    <tr valign="top">
      <td>adCmdText</td>
      <td>1</td>
      <td>Evaluates CommandText as a textual definition of a command or stored
        procedure call.</td>
    </tr>
    <tr valign="top">
      <td>adCmdTable</td>
      <td>2</td>
      <td>Evaluates CommandText as a table name whose columns are all returned
        by an internally generated SQL query.</td>
    </tr>
    <tr valign="top">
      <td>adCmdStoredProc</td>
      <td>4</td>
      <td>Evaluates CommandText as a stored procedure name.</td>
    </tr>
    <tr valign="top">
      <td>adCmdUnknown</td>
      <td>8</td>
      <td>Indicates that the type of command in the CommandText
        property is not known.</td>
    </tr>
    <tr valign="top">
      <td>adCmdFile</td>
      <td>256</td>
      <td>Evaluates CommandText as the file name of a persistently stored
        Recordset. Used with Recordset.Open or Requery only.</td>
    </tr>
    <tr valign="top">
      <td>adCmdTableDirect</td>
      <td>512</td>
      <td>Evaluates CommandText as a table name whose columns are all returned.
        Used with Recordset.Open or Requery only. To use the Seek method, the
        Recordset must be opened with adCmdTableDirect. This value cannot be
        combined with the ExecuteOptionEnum value adAsyncExecute.</td>
    </tr>
</table>
<br />
<hr />
<a name="executeoptionenum"><h3>ExecuteOptionEnum Values</h3></a>
<table class="reference">
    <tr valign="top" align="left">
      <th width="30%">Constant</th>
      <th width="10%">Value</th>
      <th width="60%">Description</th>
    </tr>
    <tr valign="top">
      <td>adOptionUnspecified</td>
      <td>-1</td>
      <td>Indicates that the command is unspecified.</td>
    </tr>
    <tr valign="top">
      <td>adAsyncExecute</td>
      <td>16</td>
      <td>Indicates that the command should execute asynchronously. This value
        cannot be combined with the CommandTypeEnum value adCmdTableDirect.</td>
    </tr>
    <tr valign="top">
      <td>adAsyncFetch</td>
      <td>32</td>
      <td>Indicates that the remaining rows after the initial quantity specified
        in the CacheSize property should be retrieved asynchronously.</td>
    </tr>
    <tr valign="top">
      <td>adAsyncFetchNonBlocking</td>
      <td>64</td>
      <td>Indicates that the main thread never blocks while retrieving. If the
        requested row has not been retrieved, the current row automatically
        moves to the end of the file. If you open a Recordset from a Stream
        containing a persistently stored Recordset, adAsyncFetchNonBlocking will
        not have an effect; the operation will be synchronous and blocking.
        adAsynchFetchNonBlocking has no effect when the adCmdTableDirect option
        is used to open the Recordset.</td>
    </tr>
    <tr valign="top">
      <td>adExecuteNoRecords</td>
      <td>128</td>
      <td>Indicates that the command text is a command or stored procedure that
        does not return rows (for example, a command that only inserts data). If
        any rows are retrieved, they are discarded and not returned.
        adExecuteNoRecords can only be passed as an optional parameter to the
        Command or Connection Execute method.</td>
    </tr>
    <tr valign="top">
      <td>adExecuteStream</td>
      <td>256</td>
      <td>Indicates that the results of a command execution should be returned
        as a stream. adExecuteStream can only be passed as an optional parameter
        to the Command Execute method.</td>
    </tr>
    <tr valign="top">
      <td>adExecuteRecord</td>
      <td>512</td>
      <td>Indicates that the CommandText is a command or stored procedure that
        returns a single row which should be returned as a Record object.</td>
    </tr>
</table>
<br />
<hr />
<a name="eventstatusenum"><h3>EventStatusEnum Values</h3></a>
<table class="reference">
    <tr valign="top" align="left">
      <th width="30%" valign="top">Constant</th>
      <th width="10%" valign="top">Value</th>
      <th width="60%" valign="top">Description</th>
    </tr>
    <tr>
      <td valign="top">adStatusOK</td>
      <td valign="top">1</td>
      <td valign="top">The operation that fired the event was successful</td>
    </tr>
    <tr>
      <td valign="top">adStatusErrorsOccurred</td>
      <td valign="top">2</td>
      <td valign="top">The operation that fired the event failed</td>
    </tr>
    <tr>
      <td valign="top">adStatusCantDeny</td>
      <td valign="top">3</td>
      <td valign="top">Cannot cancel the pending operation</td>
    </tr>
    <tr valign="top">
      <td valign="top">adStatusCancel</td>
      <td valign="top">4</td>
      <td valign="top">Cancels the operation that fired the event</td>
    </tr>
    <tr>
      <td valign="top">adStatusUnwantedEvent</td>
      <td valign="top">5</td>
      <td valign="top">Prevents subsequent notifications before the event method has finished
        executing</td>
    </tr>
</table>
<br />
<hr />
<a href="ado_ref_connection.html"><img class="navup" src="http://www.w3schools.com/images/up.gif" alt="Connection Object Reference" border="0" /> Complete Connection Object Reference</a>

<p>From <b>http://www.w3schools.com</b> (Copyright Refsnes Data)</p>

</body>

<!-- Mirrored from www.w3schools.com/ado/ev_conn_execute.asp?output=print by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 15 Oct 2011 23:50:07 GMT -->
</html>