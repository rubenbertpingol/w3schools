<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-US" xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from www.w3schools.com/asp/asp_contentrotator.asp?output=print by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 15 Oct 2011 23:17:31 GMT -->
<head>

<title>ASP Content Rotator</title>
 
<link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="Keywords" content="html,css,tutorial,html5,dhtml,css3,xsl,xslt,xhtml,javascript,jquery,asp,ado,net,vbscript,dom,sql,colors,soap,php,rss,authoring,programming,training,learning,quiz,beginner's guide,primer,lessons,school,howto,reference,examples,samples,source code,tags,demos,tips,links,FAQ,tag list,forms,frames,color table,w3c,cascading style sheets,active server pages,dynamic html,internet,database,development,Web building,Webmaster,html guide" />

<meta name="Description" content="Free HTML XHTML CSS JavaScript jQuery XML DOM XSL XSLT RSS AJAX ASP .NET PHP SQL tutorials, references, examples for web building." />

<link rel="stylesheet" type="text/css" href="../stdtheme.css" />
<script type="text/javascript">
<!--
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
//-->
</script>
<script type="text/javascript">
<!--
function searchfield_focus(obj)
{
obj.style.color=""
obj.style.fontStyle=""
if (obj.value=="Search w3schools.com")
	{
	obj.value=""
	}
}

var pageTracker = _gat._getTracker("UA-3855518-1");
pageTracker._initData();
pageTracker._trackPageview();

var addr=document.location.href;
function displayError()
{
document.getElementById("err_url").value=addr;
document.getElementById("err_form").style.display="block";
document.getElementById("err_desc").focus();
hideSent();
}
function hideError()
{
document.getElementById("err_form").style.display="none";
}
function hideSent()
{
document.getElementById("err_sent").style.display="none";
}
function sendErr()
{
var xmlhttp;
var err_url=document.getElementById("err_url").value;
var err_email=document.getElementById("err_email").value;
var err_desc=document.getElementById("err_desc").value;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }

xmlhttp.open("POST","../err_sup.html",true);
xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
xmlhttp.send("err_url=" + err_url + "&err_email=" + err_email + "&err_desc=" + escape(err_desc));
hideError();
document.getElementById("err_sent").style.display="block";
}

function click_expandingMenuHeader(obj,sectionName)
{
var x=document.getElementById("cssprop_" + sectionName).parentNode.className;
if (x.indexOf("expandingMenuNotSelected")>-1)
	{
	x=x.replace("expandingMenuNotSelected","expandingMenuSelected");
	document.getElementById("cssprop_" + sectionName).parentNode.className=x;
	document.getElementById("cssprop_" + sectionName).style.display="block";
	}
else
	{
	x=x.replace("expandingMenuSelected","expandingMenuNotSelected");
	document.getElementById("cssprop_" + sectionName).parentNode.className=x;
	document.getElementById("cssprop_" + sectionName).style.display="none";
	}
}

//-->
</script>
<!--[if lt IE 7]>
<style>
#leftcolumn{margin-left:0}
</style>
<![endif]-->
</head>
<body>

<p>From <b>http://www.w3schools.com</b> (Copyright Refsnes Data)</p>

<h1>ASP <span class="color_h1">Content Rotator</span> Component (ASP 3.0)</h1>
<div class="chapter">
<div class="prev"><a class="chapter" href="asp_contentlinking.html">&laquo; Previous</a></div>
<div class="next"><a class="chapter" href="asp_ajax_intro.html">Next Chapter &raquo;</a></div>
</div>
<hr />
<h2>ASP Content Rotator Component</h2>
<p>The ASP Content Rotator component creates a ContentRotator object that displays a
different content string each time a visitor enters or refreshes a page.</p>
<p>A
text file, called the Content Schedule File, includes the information about the content strings.</p>
<p>The content strings can contain HTML tags so you can display any type 
of content that HTML can represent: text, images, colors, or hyperlinks.</p>

<h3>Syntax</h3>

<table class="code notranslate" cellspacing="0" cellpadding="0" border="0" width="100%">
<tr><td>
&lt;%<br />
Set cr=Server.CreateObject(&quot;MSWC.ContentRotator&quot;)<br />
%&gt;</td></tr></table>
<br />
<hr />

<h2>ASP Content Rotator Example</h2>

<p>The following example displays a different content each time a visitor views 
the Web page.</p>
<p>First, create a text file named &quot;textads.txt&quot; and place it in a subfolder called 
&quot;text&quot;.</p>
<p>&quot;textads.txt&quot;:</p>

<table class="code notranslate" cellspacing="0" cellpadding="0" border="0" width="100%">
<tr><td>
%% #3 <br />
&lt;h2&gt;This is a great day!!&lt;/h2&gt;<br /><br />
%% #3<br />
&lt;img src=&quot;smiley.gif&quot;&gt;<br /><br />
%% #4<br />
&lt;a href=&quot;http://www.w3schools.com&quot;&gt;Visit W3Schools.com&lt;/a&gt;</td></tr></table>

<p>Notice the #number at the beginning of each content string. This number is 
an optional parameter that indicates the relative weight of the HTML content 
string. In the text file above, the Content Rotator will display the first and 
second content 
string three-tenth of the time, and the third string four-tenths of 
the time.</p>
<p>Then, create an ASP file, and insert the following code:</p>

<table class="example" border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td>
<h2 class="example">Example</h2>
<table class="example_code notranslate" border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td>
&lt;html&gt;<br />
&lt;body&gt;<br />
&lt;%<br />
set cr=server.createobject(&quot;MSWC.ContentRotator&quot;)<br />
response.write(cr.ChooseContent(&quot;text/textads.txt&quot;))<br />
%&gt;<br />
&lt;/body&gt;<br />
&lt;/html&gt;
</td></tr></table>
<br /><a target="_blank" href="showasp2f5c.html?filename=demo_contentrotator" class="showbtn">Show example &raquo;</a>
</td></tr></table>
<br />
<hr />

<h2>ASP Content Rotator Component's Methods</h2>

<table class="reference">
  <tr valign="top">
    <th width="15%" align="left">Method</th>
    <th width="35%" align="left">Description</th>
    <th width="50%" align="left">Example</th>
  </tr>
  <tr valign="top">
    <td>ChooseContent</td>
    <td>Gets and displays a content string</td>
    <td>&lt;%<br />
    dim cr<br />
    Set cr=Server.CreateObject(&quot;MSWC.ContentRotator&quot;) <br />
      response.write(cr.ChooseContent(&quot;text/textads.txt&quot;))<br />
    %&gt;<p>Output:<br />
    <br />
    <img border="0" src="smiley.gif" alt="Smiley"></td>
  </tr>
  <tr valign="top">
    <td>GetAllContent</td>
    <td> Retrieves and displays all of the content strings in the text file</td>
    <td> &lt;%<br />
    dim cr<br />
    Set cr=Server.CreateObject(&quot;MSWC.ContentRotator&quot;) <br />
      response.write(cr.GetAllContent(&quot;text/textads.txt&quot;))<br />
    %&gt;
    <p>Output:</p>
    <h2>This is a great day!!</h2>
    <p><img src="smiley.gif" alt="Smiley"></p>
    <p><a href="../index.html">Visit W3Schools.com</a></p></td>
  </tr>
</table>
<br />
<div class="chapter">
<div class="prev"><a class="chapter" href="asp_contentlinking.html">&laquo; Previous</a></div>
<div class="next"><a class="chapter" href="asp_ajax_intro.html">Next Chapter &raquo;</a></div>
</div>

<p>From <b>http://www.w3schools.com</b> (Copyright Refsnes Data)</p>

</body>

<!-- Mirrored from www.w3schools.com/asp/asp_contentrotator.asp?output=print by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 15 Oct 2011 23:17:31 GMT -->
</html>